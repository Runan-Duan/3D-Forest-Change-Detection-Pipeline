legend.args = list(text = "Height (m)", side = 2, line = 1))
# Alternative approach using layout for more control:
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 2), heights = 3)
# Plot 1
image(smoothed_2024, col = col, zlim = zlim, main = "Smoothed CHM 2024",
xlab = "Easting (m)", ylab = "Northing (m)",)
# Plot 2
image(smoothed_2025, col = col, zlim = zlim, main = "Smoothed CHM 2025",
xlab = "Easting (m)", ylab = "",)
#
# # Colorbar
image.plot(zlim = zlim, col = col, legend.only = TRUE,
legend.args = list(text = "Height (m)", side = 2, line = 1))
# Alternative approach using layout for more control:
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(5, 5, 2), heights = 3)
# Plot 1
image(smoothed_2024, col = col, zlim = zlim, main = "Smoothed CHM 2024",
xlab = "Easting (m)", ylab = "Northing (m)",)
# Alternative approach using layout for more control:
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 2), heights = 3)
# Plot 1
image(smoothed_2024, col = col, zlim = zlim, main = "Smoothed CHM 2024",
xlab = "Easting (m)", ylab = "Northing (m)",)
# Alternative approach using layout for more control:
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 2))
# Plot 1
image(smoothed_2024, col = col, zlim = zlim, main = "Smoothed CHM 2024",
xlab = "Easting (m)", ylab = "Northing (m)",)
# Alternative approach using layout for more control:
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Plot 1
image(smoothed_2024, col = col, zlim = zlim, main = "Smoothed CHM 2024",
xlab = "Easting (m)", ylab = "Northing (m)",)
# Plot 2
image(smoothed_2025, col = col, zlim = zlim, main = "Smoothed CHM 2025",
xlab = "Easting (m)", ylab = "",)
#
# # Colorbar
image.plot(zlim = zlim, col = col, legend.only = TRUE,
legend.args = list(text = "Height (m)", side = 2, line = 1))
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(4, 4, 3, 1),     # Margins for individual plots
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
par(mar = c(4, 1, 3, 3))     # Adjust margins for colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.8,
legend.width = 1.5,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1.1))
# Reset plotting parameters
layout(1)  # Reset layout
par(mar = c(5, 4, 4, 2))  # Reset margins
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(4, 4, 3, 1),     # Margins for individual plots
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
par(mar = c(4, 1, 3, 3))     # Adjust margins for colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.8,
legend.width = 1.5,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1.1))
# Reset plotting parameters
layout(1)  # Reset layout
par(mar = c(3, 3, 3, 1))  # Reset margins
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(4, 4, 3, 1),     # Margins for individual plots
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
par(mar = c(4, 1, 3, 3))     # Adjust margins for colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.8,
legend.width = 1,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1))
# Reset plotting parameters
layout(1)  # Reset layout
par(mar = c(3, 3, 3, 1))  # Reset margins
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(4, 4, 3, 1),     # Margins for individual plots
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
par(mar = c(4, 1, 3, 3))     # Adjust margins for colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.8,
legend.width = 1,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1))
# Reset plotting parameters
layout(1)  # Reset layout
par(mar = c(5, 4, 4, 3))  # Reset margins
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(4, 4, 3, 1),     # Margins for individual plots
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
par(mar = c(3, 1, 2, 2))     # Adjust margins for colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.8,
legend.width = 1,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1))
# Reset plotting parameters
layout(1)  # Reset layout
par(mar = c(5, 4, 4, 3))  # Reset margins
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(4, 4, 3, 1),     # Margins for individual plots
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
par(mar = c(4, 2, 3, 3))     # Adjust margins for colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.8,
legend.width = 1,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1))
# Reset plotting parameters
layout(1)  # Reset layout
par(mar = c(5, 4, 4, 3))  # Reset margins
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(4, 4, 3, 1),     # Margins for individual plots
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
par(mar = c(3 ,1, 2, 2))     # Adjust margins for colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.8,
legend.width = 1,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1))
# Reset plotting parameters
layout(1)  # Reset layout
par(mar = c(5, 4, 4, 3))  # Reset margins
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(3 ,1, 2, 2),     # Adjust margins for colorbar
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.8,
legend.width = 1,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1))
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(3 ,1, 2, 2),     # Adjust margins for colorbar
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.5,
legend.width = 1,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1.1))
# Load required library
library(fields)  # for image.plot function
# Define color palette (corrected function name)
col <- heat.colors(25)  # Fixed: height.colors -> heat.colors
# Alternative professional color schemes:
# col <- terrain.colors(25)
# col <- topo.colors(25)
# col <- viridis::viridis(25)
# Calculate shared z-limits (0 to maximum value)
zlim <- c(0, max(values(smoothed_2024), values(smoothed_2025), na.rm = TRUE))
# Set up layout with precise control: two plots + colorbar
layout(matrix(c(1, 2, 3), nrow = 1), widths = c(4, 4, 1))
# Set plotting parameters for publication quality
par(mar = c(4, 4, 3, 1),     # Adjust margins for colorbar
cex.main = 1.2,          # Larger title text
cex.lab = 1.1,           # Larger axis labels
cex.axis = 1.0)          # Standard axis text
# Plot 1 - 2024 data
image(smoothed_2024,
col = col,
zlim = zlim,
main = "Smoothed CHM 2024",
xlab = "Easting (m)",
ylab = "Northing (m)",
)  # Square aspect ratio
# Plot 2 - 2025 data
image(smoothed_2025,
col = col,
zlim = zlim,
main = "Smoothed CHM 2025",
xlab = "Easting (m)",
ylab = "",  # No y-label for second plot
)   # Square aspect ratio
# Plot 3 - Colorbar
image.plot(zlim = zlim,
col = col,
legend.only = TRUE,
legend.shrink = 0.5,
legend.width = 1,
axis.args = list(cex.axis = 1.0),
legend.args = list(text = "Height (m)",
side = 4,
line = 1,
cex = 1.1))
# Save CHM 2024
writeRaster(smoothed_2024, filename = "smoothed_chm_2024.tif", overwrite = TRUE)
# Save CHM 2025
writeRaster(smoothed_2025, filename = "smoothed_chm_2025.tif", overwrite = TRUE)
